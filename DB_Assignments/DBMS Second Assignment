
/*  Find out the number of documentaries with deleted scenes.   */

select count(*) from film f join film_category fc on f.film_id=fc.film_id 
join category ca on ca.category_id=fc.category_id where ca.name='Documentary' and f.special_features = 'Deleted Scenes' group by special_features;


/*  Find out the number of sci-fi movies rented by the store managed by Jon Stephens.  */

select count(*) from film f join film_category fc on fc.film_id=f.film_id join category c 
on c.category_id=fc.category_id join inventory i on i.film_id=f.film_id join store s on s.store_id=i.store_id
join staff st on st.store_id=s.store_id
where c.name='Sci-Fi' and st.first_name='Jon' and st.last_name='Stephens';

 
 /* Find out the total sales from Animation movies.  */
 
 SELECT SUM(payment.amount) 
FROM payment
JOIN rental ON rental.rental_id = payment.rental_id
JOIN inventory ON inventory.inventory_id = rental.inventory_id
JOIN film ON film.film_id = inventory.film_id join film_category fc on fc.film_id =film.film_id 
join category ca on ca.category_id=fc.category_id
where ca.name='Animation';


  /* Find out the top 3 rented category of movies by “PATRICIA JOHNSON”.  */
  
 SELECT category.name, COUNT(category.category_id) as count
FROM category
JOIN film_category ON film_category.category_id = category.category_id
JOIN inventory ON inventory.film_id = film_category.film_id
JOIN rental ON rental.inventory_id = inventory.inventory_id
JOIN customer ON rental.customer_id = customer.customer_id
WHERE customer.first_name = 'PATRICIA' AND customer.last_name = 'JOHNSON'
GROUP BY category.name
ORDER BY count DESC
LIMIT 3;


/* Find out the number of R rated movies rented by “SUSAN WILSON”. */

SELECT COUNT(*) FROM rental
JOIN inventory ON rental.inventory_id = inventory.inventory_id
JOIN film ON inventory.film_id = film.film_id
WHERE rental.customer_id = (SELECT customer_id FROM customer WHERE first_name = 'SUSAN' AND last_name = 'WILSON')
AND film.rating = 'R';

